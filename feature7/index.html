<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Feature 7 — kpi </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>

  <style>
    :root{
      --ink:#0e1b16;
      --muted:#6b7c76;
      --brand:#1A7F72;
      --success:#16a34a;
      --danger:#e11d48;
      --warning:#f59e0b;
      --card:#ffffff;
      --border:#e7ecea;

      --radius: 16px;
      --shadow: 0 14px 40px rgba(0,0,0,.10);
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      background:#f6f9f8;
      color:var(--ink);
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      padding: 18px;
    }
    .shell{ max-width: 1400px; margin:0 auto; }
    .hero{
      background:#ffffff;
      border:1px solid var(--border);
      border-radius: 22px;
      padding: 26px 24px;
      box-shadow: var(--shadow);
    }
    .hero h1{ font-size: clamp(1.6rem, 2.5vw, 2.2rem); font-weight: 800; letter-spacing: .2px; }
    .hero p{ color:var(--muted); margin-top: 6px; max-width: 900px; }

    .content{ margin-top: 18px; }

    .filters{
      display:flex; gap:10px; flex-wrap: wrap; align-items: end; margin-bottom: 16px;
      background:var(--card); border:1px solid var(--border); border-radius: var(--radius); padding: 12px;
      box-shadow: var(--shadow);
    }
    .filters .field{ display:flex; flex-direction:column; gap:6px; }
    .filters label{ font-size:.85rem; font-weight:600; color:var(--muted); }
    .filters input, .filters select{
      background:#fff; color:var(--ink); border:1.6px solid var(--border);
      border-radius: 10px; padding:10px 12px; min-width: 170px;
    }
    .btn{
      border:none; border-radius: 10px; padding: 10px 14px; font-weight:700; cursor:pointer;
      color:#fff; background:var(--brand);
      box-shadow: 0 8px 18px rgba(0,0,0,.10);
    }
    .btn:hover{ filter:brightness(1.06); transform:translateY(-1px); }
    .btn.secondary{ background:#16a34a; }

    /* KPI cards */
    .kpi-grid{
      display:grid; grid-template-columns: repeat(4, minmax(240px, 1fr)); gap:14px; margin:16px 0;
    }
    .kpi{
      background:#fff; border:1px solid var(--border); border-radius: 18px; padding: 14px 16px;
      box-shadow: var(--shadow);
    }
    .kpi .label{ font-size:.95rem; color:#38433f; font-weight:600; }
    .kpi .value{ font-size: 1.8rem; font-weight:800; margin-top:6px; letter-spacing:.3px; }
    .kpi .delta{ font-size:.9rem; margin-top:6px; font-weight:700; }
    .kpi .delta.up{ color: var(--success); }
    .kpi .delta.down{ color: var(--danger); }
    .kpi .delta.flat{ color: var(--warning); }

    /* Charts grid = 3 neat rows */
    .grid{
      display:grid;
      gap:16px;
      grid-template-columns: repeat(12, minmax(0,1fr));
    }
    .card{
      background:#fff; border:1px solid var(--border); border-radius: var(--radius); padding: 14px;
      box-shadow: var(--shadow);
    }
    .card h3{ font-size: 1.05rem; margin-bottom: 10px; }
    canvas{
      width:100% !important;
      height:320px !important;
      display:block;
      background:#fff;
      border-radius: 12px;
    }
    .span-12{ grid-column: span 12; }
    .span-8 { grid-column: span 8; }
    .span-4 { grid-column: span 4; }

    /* Leaderboard cards */
    .leaderboard{
      display:grid; gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    }
    .driver-card{
      background:#fff; border:1px solid var(--border); border-radius: 16px; padding: 12px 14px;
      display:flex; align-items:flex-start; gap:12px; box-shadow: var(--shadow);
    }
    .rank-badge{
      width:40px; height:40px; flex:0 0 40px; border-radius: 12px;
      display:flex; align-items:center; justify-content:center; color:#fff; font-weight:800;
      background: linear-gradient(135deg, #1A7F72, #21B3A2);
    }
    .driver-meta{ display:flex; flex-direction:column; gap:4px; }
    .driver-name{ font-weight:800; }
    .driver-metrics{ color:var(--muted); font-size:.9rem; line-height:1.35; }

    /* KPI table */
    .table-card{
      background:#fff; border:1px solid var(--border); border-radius: 16px; padding: 14px;
      margin-top: 18px; box-shadow: var(--shadow);
    }
    table{ width:100%; border-collapse: collapse; }
    thead th{
      text-align:left; background:#0F1916; color:#EAF5F1; padding: 10px; position:sticky; top:0;
      border-radius: 10px;
    }
    tbody td{ padding: 10px; border-bottom:1px solid var(--border); }
    tbody tr:hover{ background:#f5faf8; }
    .muted{ color:#6b7c76; }

    @media (max-width: 1100px){
      .kpi-grid{ grid-template-columns: repeat(2, 1fr); }
      .span-12,.span-8,.span-4{ grid-column: span 12; }
      canvas{ height:300px !important; }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="hero">
      <h1>Key Perfomance Indicators (KPIs)</h1>
      <p>Bright, compact analytics for your supply chain. Filters update all cards & charts instantly.</p>
    </div>

    <div class="content">
      <!-- Filters -->
      <div class="filters">
        <div class="field">
          <label for="fromDate">From</label>
          <input type="date" id="fromDate">
        </div>
        <div class="field">
          <label for="toDate">To</label>
          <input type="date" id="toDate">
        </div>
        <div class="field">
          <label for="destinationSel">Destination</label>
          <select id="destinationSel"><option value="">All</option></select>
        </div>
        <div class="field">
          <label for="driverSel">Driver</label>
          <select id="driverSel"><option value="">All</option></select>
        </div>
        <div class="field">
          <label for="transportSel">Transport</label>
          <select id="transportSel"><option value="">All</option></select>
        </div>
        <div class="field">
          <label for="routeSel">Route</label>
          <select id="routeSel"><option value="">All</option></select>
        </div>
        <div class="field">
          <label for="statusSel">Status</label>
          <select id="statusSel">
            <option value="">All</option>
            <option>Planned</option>
            <option>In Transit</option>
            <option>Delivered</option>
            <option>Pending</option>
          </select>
        </div>
        <button class="btn" id="applyBtn">Apply</button>
        <button class="btn secondary" id="resetBtn">Reset</button>
      </div>

      <!-- KPI cards -->
      <div class="kpi-grid">
        <div class="kpi">
          <div class="label">Total Shipments</div>
          <div class="value" id="kpiTotalShipments">0</div>
          <div class="delta" id="deltaTotalShipments"></div>
        </div>
        <div class="kpi">
          <div class="label">Dispatched (with Progress)</div>
          <div class="value" id="kpiDispatched">0</div>
          <div class="delta" id="deltaDispatched"></div>
        </div>
        <div class="kpi">
          <div class="label">Delivered</div>
          <div class="value" id="kpiDelivered">0</div>
          <div class="delta" id="deltaDelivered"></div>
        </div>
        <div class="kpi">
          <div class="label">Avg Planned Transit (hrs)</div>
          <div class="value" id="kpiAvgTransit">—</div>
          <div class="delta" id="deltaAvgTransit"></div>
        </div>
        <div class="kpi">
          <div class="label">Total Transport Cost</div>
          <div class="value" id="kpiTotalCost">—</div>
          <div class="delta" id="deltaTotalCost"></div>
        </div>
        <div class="kpi">
          <div class="label">Avg Cost / Shipment</div>
          <div class="value" id="kpiAvgCost">—</div>
          <div class="delta" id="deltaAvgCost"></div>
        </div>
        <div class="kpi">
          <div class="label">Cost per KM</div>
          <div class="value" id="kpiCostPerKm">—</div>
          <div class="delta" id="deltaCostPerKm"></div>
        </div>
        <div class="kpi">
          <div class="label">Dispatch Compliance</div>
          <div class="value" id="kpiDispatchCompliance">—</div>
          <div class="delta" id="deltaDispatchCompliance"></div>
        </div>
      </div>

      <!-- Charts — neatly arranged in 3 rows -->
      <div class="grid">
        <!-- Row 1 -->
        <div class="card span-8">
          <h3>Shipment Volume & Status Trend (Daily)</h3>
          <canvas id="volumeStatusDaily"></canvas>
        </div>
        <div class="card span-4">
          <h3>On-Time Delivery Rate (Weekly)</h3>
          <canvas id="onTimeWeekly"></canvas>
        </div>

        <!-- Row 2 -->
        <div class="card span-8">
          <h3>Transport Cost per Destination & Cost-per-Km</h3>
          <canvas id="costByDestination"></canvas>
        </div>
        <div class="card span-4">
          <h3>Spoilage Rate (Pie)</h3>
          <canvas id="spoilagePie"></canvas>
        </div>

        <!-- Row 3 -->
        <div class="card span-12">
          <h3>Driver Reliability — Top 5 Leaderboard</h3>
          <div id="driverLeaderboardList" class="leaderboard"></div>
        </div>
      </div>

      <!-- KPI Table (Top 5) -->
      <div class="table-card">
        <h3 style="margin-bottom:10px;">Key Performance Indicators (Top 5)</h3>
        <div style="overflow:auto; border:1px solid var(--border); border-radius:10px; margin-top:10px;">
          <table>
            <thead>
              <tr>
                <th style="width: 40%;">KPI</th>
                <th>Value</th>
                <th>Definition</th>
              </tr>
            </thead>
            <tbody id="kpiTop5Body"></tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
